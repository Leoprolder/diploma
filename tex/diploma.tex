\documentclass[14pt,a4paper,twosided]{extreport}%размер бумаги - А4, шрифт - 14, класс документа - отчет
\usepackage[cp1251]{inputenc}%кодировка символов:koi8-r или utf8 в UNIX, cp1251 в Windows
\usepackage[english,russian]{babel}%используем русский и английский языки с переносами
\usepackage{DiplomaSUSU}%оформляем согласно нормоконтролю дипломных работ студентов кафедры математического и компьютерного моделирования ЮУрГУ

\begin{document}

\input{title}

\newpage

\setcounter{page}{2}
\input{summary}

\newpage

\newpage
\renewcommand{\contentsname}{ \begin{center} ОГЛАВЛЕНИЕ \end{center}  }%размер, положение и название оглавления
\tableofcontents%команда автоматической генерации оглавления
\newpage

\chapter*{Введение}\addcontentsline{toc}{section}{\hspace{-0.9cm}ВЕДЕНИЕ }

\zerocounters
\chapter*{Методы разработки приложений, обработка информации}\addcontentsline{toc}{section}{\hspace{-1.2cm} \thechapter. ОБЩАЯ ИНФОРМАЦИЯ ОБ АКЦИЯХ, МЕТОДЫ РАЗРАБОТКИ ПРИЛОЖЕНИЙ, ОБРАБОТКА ИНФОРМАЦИИ }

\section{Информация об акциях}%section

\subsection{Категории акций}
Различают обыкновенные и привилегированные акции:

\begin{enumerate}
\item{Обыкновенные акции дают право на участие в управлении обществом (обычно, 1 акция соответствует одному голосу на собрании акционеров, за исключением проведения кумулятивного голосования) и участвуют в распределении прибыли акционерного общества. Источником выплаты дивидендов по обыкновенным акциям является чистая прибыль общества. Размер дивидендов определяется советом директоров предприятия и рекомендуется общему собранию акционеров, которое может только уменьшить размер дивидендов относительно рекомендованного советом директоров. Распределение дивидендов между владельцами обыкновенных акций осуществляется пропорционально вложенным средствам (в зависимости от количества купленных акций).}
\item{Привилегированные акции могут вносить ограничения на участие в управлении, а также могут давать дополнительные права в управлении (не обязательно), но по сравнению с обыкновенными акциями имеют ряд преимуществ: возможность получения гарантированного дохода, первоочередное выделение прибыли на выплату дивидендов, первоочередное погашение стоимости акции при ликвидации акционерного общества. Дивиденды часто фиксированы в виде определённой доли от бухгалтерской чистой прибыли или в абсолютном денежном выражении. Дивиденды по привилегированным акциям могут выплачиваться как из прибыли, так и из других источников — в соответствии с уставом общества. Привилегированные акции делятся на:
    \begin{itemize}
    \item{Привилегированные имеют ряд привилегий в обмен на право голоса. У их собственника определена величина дохода в момент выпуска и размещения ценных бумаг. Определён размер ликвидационной стоимости. Приоритет при начислении этих выплат по отношению к обыкновенным.}
    \item{Кумулятивные (накапливающие). Привилегии — те же. Сохраняется и накапливается обязательство по выплате дивидендов. Фиксированный срок накопления дивидендов. При невыплате дивидендов обладатели этого вида акций получают право голоса на период до выплаты дивидендов.}
    \end{itemize}
    }
\end{enumerate}

Аналог привилегированных акций — акция учредительская (англ. founders share) — акция, распространяемая среди учредителей акционерных компаний и дающая им некоторые преимущественные права. Держатели таких акций могут:

\begin{itemize}
\item{иметь дополнительное количество голосов на собрании акционеров;}
\item{пользоваться первоочередным правом на получение акций в случае их последующих эмиссий;}
\item{играть главную роль в решении всех вопросов, связанных с деятельностью акционерных компаний.}
\end{itemize}

По именным акциям данные об их владельцах регистрируются в реестре акционерного общества. В соответствии с законодательством физические и юридические лица могут быть владельцами именных акций.

Акции на предъявителя допускают их свободную куплю-продажу на вторичном рынке без необходимости перерегистрации владельца. Российское законодательство допускало выпуск акций на предъявителя до 2002 года. С 2003 года акции могут выпускаться только в форме именной ценной бумаги.

\subsection{Стоимость акций}

Различают разные виды стоимости акций:

\begin{enumerate}
\item{Номинальная стоимость акции — это то, что указано на её лицевой стороне (иногда её называют нарицательной стоимостью). Общая величина уставного капитала равна общей сумме номиналов всех выпущенных акций.

Номинальная стоимость всех обыкновенных акций общества должна быть одинаковой.

Номинальная стоимость не обязана отражать реальную ценность акций. Однако она часто используется для ряда операций (оценка пошлин, комиссий, тарифов), особенно на неразвитом, малоликвидном фондовом рынке. Цена акций при первичном размещении не должна быть ниже номинальной стоимости.}
\item{Эмиссионная стоимость акции — стоимость акций при их первичном размещении, по которой её приобретает первый держатель. Обычно эмиссионная цена акции превышает номинальную стоимость или равна ей. Превышение эмиссионной цены над номинальной стоимостью называется эмиссионной выручкой, или эмиссионным доходом.}
\item{Балансовая стоимость акций — частное от деления стоимости чистых активов компании (балансовой стоимости компании) на количество выпущенных акций, находящихся в обращении. Если рыночная цена ниже балансовой, то это является основой для будущего биржевого роста цены. Обычно балансовую стоимость определяют при аудиторских проверках.}
\item{Рыночная стоимость акции — это цена, по которой акция продаётся и покупается на вторичном рынке. Рыночная цена (котировка, курс) обычно формируется на торгах на фондовой бирже и отражает баланс спроса и предложения на данные акции. Для формирования рыночной цены важное значение имеет уровень ликвидности фондового рынка. Косвенно, рыночная стоимость акций отражает ликвидационную стоимость активов и пассивов компании.}
\end{enumerate}

\section{Общие сведения о биржах}%section
Фондовая биржа — это финансовый институт, обеспечивающий регулярное функционирование организованного рынка ценных бумаг.

В каждой стране мира с рыночной экономикой есть национальная фондовая биржа. Это организованный рынок для торговли ценными бумагами: акциями, облигациями и другими финансовыми инструментами.

Для допуска к торгам на бирже акции должны пройти процедуру листинга или быть допущены к торгам без прохождения процедуры листинга.

Участие акции в торгах позволяет эмитенту привлечь самый дешёвый и самый долгосрочный капитал, повысить стоимость компании, снизить стоимость заимствований, поднять свой престиж, осуществлять дополнительную рекламу через биржевые каналы и успешно размещать последующие выпуски.

В данной работе будут рассматриваться биржи NASDAQ (сокр. от англ. National Association of Securities Dealers Automated Quotation, читается как «Насдак» — Автоматизированные котировки Национальной ассоциации дилеров по ценным бумагам) — американская биржа, специализирующаяся на акциях высокотехнологичных компаний (производство электроники, программного обеспечения и т. п.) и корейская биржа (англ. Korea Exchange, KRX) — крупнейшая в мире биржа по объему сделок с деривативами.

\section{Выбор средств разработки}%section

Для разработки аналитического приложения, способного самостоятельно собирать данные с интернет-ресурса в режиме реального времени нужна развитая платформа с большим набором инструментов. Для этих целей как раз подходит платформа Microsoft .Net Framework.

\subsection{Язык C\#, платформа .Net Framework}

На сегодняшний день C\# и платформа .Net Framework являются одними из наиболее популярных инструментов у разработчиков по всему миру. На этой платформе можно реализовать совершенно разные решения: от простейших консольных программ до сложнейших научных библиотек и микросервисов в веб-стеке.

Язык проектировался как полностью объектно-ориентированный, и его компания-разработчик Microsoft всегда выделяет это свойство языка в качестве его главных преимуществ. Ещё одним преимуществом является сравнительно низкий порог входа, обеспечивая вместе с тем большую потенциальную мощность разрабатываемых приложений.

Ещё одним преимуществом языка C\# и платформы .Net Framework является развитое сообщество. Этот факт выводит возможности встроенного пакетного менеджера NuGet на новый уровень: любой желающий может разработать своё собственное решение задачи и загрузить его на сервер Microsoft в открытый доступ.

\subsection{Библиотеки}

В разработанном приложении использованы следующие библиотеки:
\begin{enumerate}
\item{HtmlAgilityPack. Данный пакет позволяет получать html-код веб-страницы и предлагает удобные методы для парсинга DOM-дерева с помощью XPath-строки;}
\end{enumerate}

\subsection{Система контроля версий Git}

Система контроля версий — это система, записывающая изменения в файл или набор файлов в течение времени и позволяющая вернуться позже к определённой версии.

Ядро Git представляет собой набор команд для командной строки с параметром. Все настройки хранятся в текстовых файлах. Такая система позволяет сделать Git легко портируемым на любую платформу и легко интегрировать в любую систему.

Репозиторий Git представляет собой каталог на диске, содержащий файлы проекта и файлы конфигурации. Сам репозиторий загружается на удалённый сервер после вносимых изменений для возможности работы на разных устройствах.

Управление изменениями и репозиторием происходит посредством текстовых команд из командного окна: "git add", "git commit", "git push", "git pull" и так далее. Пример представлен на ~\ref{rls:git}.

\begin{figure}[h]
\centering
\includegraphics[width=0.8\linewidth]{git.PNG}
\caption{Командное окно Git Bash}
\label{rls:git}
\end{figure}

\newpage

\section{Выводы по разделу}%section

Из обзора видно, что необходима платформа, которая сможет совместить в себе возможность получения информации из интернет-ресурсов и мощные аналитические инструменты для работы с собранными данными. 

В данном случае будет разработана программа, анализирующая временной ряд, образованный изменениями цен акций "Samsung Electronics Co.". Но разработав такую программу, её можно применить на любые аналогичные данные.

В качестве платформы для разработки выберем язык C\# на платформе .Net Framework, так как он отвечает всем необходимым требованиям.
\zerocounters
\chapter*{Разработка приложения}\addcontentsline{toc}{section}{\hspace{-1.2cm} \thechapter. РАЗРАБОТКА ПРИЛОЖЕНИЯ }

\section{Написание алгоритма работы программы}%section
Для разработки приложения, которое будет самостоятельно собирать данные с удалённых источников и в последствии их анализировать, необходимо реализовать следующие возможности:
\begin{enumerate}
\item[$-$] сбор данных непосредственно с удалённой веб-страницы;
\item[$-$] сериализация собранных данных;
\item[$-$] асинхронное чтение собранных ранее данных и запись их в память;
\item[$-$] прогноз будущих значений;
\item[$-$] отображение полученных данных на пользовательской форме.
\end{enumerate}

Приложение разработано под ОС Windows. Для запуска необходимо выполнить исполняемый файл. Основной алгоритм представлен на ~\ref{rls:algorithm}.

\begin{figure}[h]
\centering
\includegraphics[width=0.17\linewidth]{algorithm.PNG}
\caption{Основной алгоритм программы}
\label{rls:algorithm}
\end{figure}

\newpage

\subsection{Проектирование внутренней структуры, применение паттернов разработки}

Основной рабочей структурой в программе являются аналитические модули. Они организованы в соответствии с паттерном проектирования "фабричный метод". На языке диаграмм UML можно представить структуру следующим образом (~\ref{rls:PredictorFactoryUml}).

\begin{figure}[h]
\centering
\includegraphics[width=1.0\linewidth]{PredictorFactoryUml.PNG}
\caption{Описание паттерна проектирования "фабричный метод"}
\label{rls:PredictorFactoryUml}
\end{figure}

\subsection{Разработка аналитических модулей}

В программе имеется три аналитических модуля, реализующие различные прогнозирующие методы:
\begin{enumerate}
\item[$-$] метод простого скользящего среднего;
\item[$-$] метод авторегрессионного скользящего среднего;
\item[$-$] метод гусеницы.
\end{enumerate}

Доступ к модулям осуществляется из класса-сборщика PredictorFactory. На вход помещается временной ряд, требуемая точность прогнозирования и тип прогнозирующего метода.

Далее, в зависимости от типа, выбирается соответствующий метод, и ему в обработку передаётся временной ряд и заданная точность.

\section{Разработка пользовательского интерфейса}

Для базового управления процессом и вывода результатов пользователю используется технология WinForms. 

\section{Выводы по разделу}

В этом разделе было разработано приложение, следящее за изменением цен на акции "Samsung Electronics Co.", и анализирующее собранные результаты тремя разным методами прогнозирования.

\zerocounters
\chapter*{Анализ данных}\addcontentsline{toc}{section}{\hspace{-1.2cm} \thechapter. АНАЛИЗ ДАННЫХ }

\section{Обзор методов прогнозирования данных}

Технический анализ – наиболее распространенный вид анализа валютного рынка. Он дарит ощущение полного контроля в прогнозах торгующего человека. Суть его заключается в анализе прошлого, так трейдеры анализируют прошедшие котировки и уровни цены, и на основе этого делают выводы о будущем.

Методология состоит из анализа ценовых фигур, которые состоят из прошедших котировок валютной пары, анализа линий сопротивления/поддержки (линии, которые цене пройти наиболее тяжело), а также использования специальных математических индикаторов, которые сигнализируют о состоянии на валютном рынке.

Так как наше приложение свободно манипулирует большим количеством текущих и прошлых данных, этот вид анализа наиболее подходящий.

\subsection{Простое скользящее среднее}

Метод простого скользящего среднего (MA) основан на выборе некоторого числа последних элементов и подсчёте их среднего арифметического. Такое число считается следующим порядковым числом, идущим за выборкой. Модель скользящего среднего порядка q обозначается MA(q) и записывается следующим образом:

$$ X_t = \sum^{q}_{i=1}{\theta_i\varepsilon_{t-i} + \varepsilon_t}, $$

где $\theta_1, ..., \theta_q - $ параметры модели, а $\varepsilon_t, ..., \varepsilon_{t-q} - $ ошибки.

\subsection{Авторегрессионное скользящее среднее}

Авторегрессионное скользящее среднее (ARMA), также называемая иногда моделью Бокса-Дженкинса, является объединением двух моделей исследования временных рядов: авторегрессионной (AR) и модели простого скользящего среднего (MA). Под обозначением ARMA(p,q) понимается модель, содержащая p авторегрессионных составляющих и q скользящих средних. Точнее модель ARMA(p,q) включает в себя модели AR(p) и MA(q):

$$ X_t = с + \sum^{q}_{i=1}{\theta_i\varepsilon_{t-i}} + \sum^{p}_{i=1}{\phi_i X_{t-i}}, $$

где $\phi_1, ..., \phi_p - $ параметры авторегрессионной модели, а $c - $ константа. Для простоты константу, как правило, опускают.

Обычно значения ошибки $\varepsilon_t$ полагают независимыми одинаково распределёнными случайными величинами, взятыми из нормального распределения с нулевым средним: $\varepsilon_t \sim N(0,\sigma^2)$, где $\sigma^2$ – дисперсия.

\section{Метод гусеницы}

Метод гусеницы (SSA) в базовом варианте состоит в:
\begin{enumerate}
\item развертка одномерного ряда в многомерный;
\item анализ главных компонент: сингулярное разложение выборочной ковариационной матрицы;
\item отбор главных компонент;
\item восстановление одномерного ряда.
\end{enumerate}

Таким образом, результатом применения метода является разложение временного ряда на простые компоненты. Полученное разложение может служить основой прогнозирования как самого ряда, так и его отдельных составляющих. "Гусеница" допускает естественное обобщение на многомерные временные ряды, а также на случай анализа изображений.

Рассмотрим временной ряд ${x_i}^{N}_{i=1}$, образованный последовательностью $N$ равноотстоящих значений некоторой (возможно, случайной) функции $f(t)$:

$$x_i = f((i-1)\delta t), $$

где $i=1,2,…,N$.

Отметим, что существует несколько вариантов базового алгоритма, здесь мы опишем лишь минимальный.

\subsection{Развертка одномерного ряда в многомерный}

Выберем некоторое число $M<N$ , называемое длиной гусеницы, и представим первые M значений последовательности f в качестве первой строки матрицы X . В качестве второй строки матрицы берем значения последовательности с $x_2$ по $x_{M+1}$. Последней строкой с номером $k = N - M + 1$ будут последние $M$ элементов последовательности. Эту матрицу, элементы которой равны $x_{ij} = x_{i+j-1}$, можно рассматривать как M - мерную выборку объема $k$ или $M$ - мерный временной ряд, которому соответствует M - мерная траектория (ломаная в M - мерном пространстве из $k-1$ звена. Отметим, что матрица $X$ (будем называть ее матрицей ряда) представлена в традиционном для прикладной статистики виде "строка - индивид, столбец - признак". При изложении теоретических аспектов естественным является сопоставление индивиду столбца.

Далее по обычной схеме (за исключением стандартизации признаков) проводится анализ главных компонент (АГК).

\subsection{Анализ главных компонент: сингулярное разложение 
выборочной ковариационной матрицы}

Сначала вычисляется матрица $V = (1/k)X^{T}X$. Несмотря на то, что ее элементы не центрированы, мы будем называть ее ковариационной матрицей, иногда добавляя слово "нецентральная".

Следующий шаг, как обычно в АГК, состоит в вычислении собственных чисел и собственных векторов матрицы $V$ , т.е. разложение ее $V = P\Lambda P^T$, где $\Lambda$ - диагональная матрица, на диагонали которой стоят упорядоченные по убыванию собственные числа, а $P$ - ортогональная матрица собственных векторов матрицы $V$.

Матрицы $L$ и $P$ совместно имеют множество интерпретаций, основанных на АГК. В частности, матрицу $P$ можно рассматривать как матрицу перехода к главным компонентам $XP = Y = (y1,y2,...,y_M)$.

Если изучается выборка из случайной совокупности, то собственные числа матрицы $V$ являются выборочными дисперсиями соответствующих главных компонент, а квадратные корни из них - выборочными стандартами. Графическое представление собственных чисел и некоторых функций от них в АГК традиционно используется для выявления структуры исследуемой совокупности и отбора и интерпретации главных компонент.

Заметим также, что при выборе длины гусеницы, равной $N-M+1$ , собственные вектора и главные компоненты (с точностью до нормировки) просто меняются местами.

\subsection{Отбор главных компонент}

В силу свойств матрицы $P$ мы можем представить матрицу ряда $X$ как $X = Y P^T$. Таким образом, мы получаем разложение матрицы ряда по ортогональным составляющим (главным компонентам).

В то же время преобразование $y_j = X p_j$ является линейным преобразованием исходного процесса с помощью дискретного оператора свертки, т.е.

$$y_j [l] = \sum^{M}_{q=1}{x_{lq} p_{jq}}=\sum^{M}_{q=1}{x_{l+q-1} p_{jq}}.$$

Таким образом, процедура "Гусеница" порождает набор линейных фильтров, настроенных на составляющие исходного процесса. При этом собственные векторы матрицы $V$ выступают в роли переходных функций соответствующих фильтров.

Визуальное и аналитическое изучение как собственных векторов, так и главных компонент, полученных в результате линейной фильтрации, может дать много интересной информации о структуре изучаемого процесса и свойствах составляющих его слагаемых.

В частности, среди главных компонент можно выделить

\begin{enumerate}
\item относящиеся к тренду (медленно меняющиеся);
\item периодические;
\item шумовые.
\end{enumerate}

Для нахождения периодических составляющих чрезвычайно большую визуальную информацию дает изучение двумерных графиков, аналогичных фигурам Лиссажу, когда по осям x и y откладываются различные пары собственных векторов или главных компонент. Известно, что, если по осям откладывать значения синусоиды одной и той же той же частоты, но с разными фазами, то на плоскости получается эллипс. Из ортогональности собственных векторов и главных компонент следует, что сдвиг фаз между такими парами обязательно будет равен $\pm\pi/2$ и эллипс переходит в окружность.

\subsection{Восстановление одномерного ряда}

Следующим ключевым элементом метода "Гусеница" является процедура восстановления. Эта процедура основана на разложении $X = Y P^T$. Будем говорить, что восстановление проводится по данному набору главным компонентам, если при применении формулы восстановления $X = Y\* P^T$ матрица $Y\*$ получена из матрицы $Y$ обнулением всех не входящих в набор главных компонент. Таким образом, мы можем получить интересующее нас приближение матрицы ряда или интерпретируемую часть этой матрицы.

Переход к исходному ряду формально может быть осуществлен усреднением матрицы ряда по побочным диагоналям и может привести к некоторому искажению полученной структуры.

Отметим сразу одну очень важную особенность описанного метода - его интерактивность, то есть использование диалога исследователя и ЭВМ в процессе применения метода. Причем эта интерактивность не должна рассматриваться как следствие общей тенденции развития современного программного обеспечения персональных ЭВМ. Скорее, наоборот, эффективная реализация алгоритма стала возможной только благодаря возможностям современных ПК. Его интерактивность связана с типично статистическим свойством алгоритма - необходимостью интерпретации промежуточных результатов и управлением работой алгоритма в процессе многоэтапной процедуры обработки. Опыт многолетнего использования различных реализаций алгоритма на ЭВМ разных поколений показал, что чем больше промежуточных результатов удается "увидеть", тем более полным оказывается решение поставленной задачи.

Заметим, что при программной реализации этапы приведенного выше алгоритма не воспроизводятся непосредственно. Например, этап построения матрицы $X$ отсутствует, а формулы преобразованы к виду удобному для проведения ускоренных вычислений.

\section{Реализация аналитических модулей}

Для реализации описанных выше методов был создан ряд классов, отражающих сущности операций и математических объектов.

\subsection{Блок-схема аналитических модулей}

На блок-схеме (~\ref{rls:analitycsAlgorithm}) можно увидеть процесс поступления на обработку данных, процесса выбора нужного метода прогнозирования и возврата прогнозируемого значения.

\begin{figure}[h]
\centering
\includegraphics[width=0.5\linewidth]{analitycsAlgorithm.PNG}
\caption{"Блок-схема работы аналитических модулей"}
\label{rls:analitycsAlgorithm}
\end{figure}

\newpage

\subsection{Пример работы программы}

todo

\section{Анализ стоимостей акций Samsung Electronics Co. за 2018 год}

todo

\section{Выводы по разделу}

\input{biblio}

\end{document}